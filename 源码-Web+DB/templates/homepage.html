<!doctype html>
<html lang="en">
<head>
    {% load staticfiles %}
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="{% static '/img/apple-icon.png' %}">
	<link rel="icon" type="image/png" sizes="96x96" href="{% static '/img/favicon.png' %}">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>智慧养老系统</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link href="{% static '/css/bootstrap.min.css' %}" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="{% static '/css/animate.min.css' %}" rel="stylesheet"/>

    <!--  Paper Dashboard core CSS    -->
    <link href="{% static '/css/paper-dashboard.css' %}" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="{% static '/css/demo.css' %}" rel="stylesheet" />


    <link href="{% static '/css/themify-icons.css' %}" rel="stylesheet">

</head>
<body>

<header class=toph >
    <div style="text-align:center">
        <h3 title="Camp Chippewa"><img class="logo" src="{% static '/img/toph2.png' %}" alt="Camp Chippewa"></h3>
    </div>
</header>


<div class="wrapper">
    <div class="sidebar" data-background-color="white" data-active-color="danger">

    <!--
		Tip 1: you can change the color of the sidebar's background using: event-background-color="white | black"
		Tip 2: you can change the color of the active button using the event-active-color="primary | info | success | warning | danger"
	-->

    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="#" class="simple-text">
                    <img class="logo" src="{% static '/img/logo.png' %}" alt="Camp Chippewa">
                    5 Pigs
                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="/homepage">
                        <i class="ti-panel"></i>
                        <p>主页</p>
                    </a>
                </li>
                <li>
                    <a href="/getinfo_old">
                        <i class="ti-user"></i>
                        <p>人员管理</p>
                    </a>
                </li>
                <li>
                    <a href="/eventRecord">
                        <i class="ti-view-list-alt"></i>
                        <p>事件记录</p>
                    </a>
                </li>
                <li>
                    <a href="/statistic">
                        <i class="ti-text"></i>
                        <p>统计分析</p>
                    </a>
                </li>
            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar bar1"></span>
                        <span class="icon-bar bar2"></span>
                        <span class="icon-bar bar3"></span>
                    </button>
                    <a class="navbar-brand" href="#">主页</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/update_sys">
								<i class="ti-user"></i>
								<p>个人信息</p>
                            </a>
                        </li>
                        <li>
                            <a href="/logout">
								<i class="ti-back-left"></i>
								<p>退出</p>
                            </a>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>


        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-2 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-warning text-center">
                                            <i class="ti-server"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>情感</p>
                                            <p id="feeling"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-success text-center">
                                            <i class="ti-wallet"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>交互</p>
                                            <p id="communication"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-calendar"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-danger text-center">
                                            <i class="ti-pulse"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>摔倒</p>
                                            <p id="trip"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-timer"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-info text-center">
                                            <i class="ti-twitter-alt"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>陌生人</p>
                                            <p id="stranger"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="content">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="icon-big icon-danger text-center">
                                            <i class="ti-pulse"></i>
                                        </div>
                                    </div>
                                    <div class="col-xs-7">
                                        <div class="numbers">
                                            <p>禁止区域闯入</p>
                                            <p id="intrude"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="footer">
                                    <hr />
                                    <div class="stats">
                                        <i class="ti-timer"></i> Updated now
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <center>
                    <h2 id="times"></h2>
                    </center>
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">实时监控-摄像头1</h4>
                                <p class="category">24 Hours performance</p>
                                <center>
                                    <img id="pic" src="{% static '/img/wait.gif' %}">
                                    <img id="pic1" src="{% url 'video_feed' %}">
                                </center>


                            </div>
                            <div class="content">
                                <!-- <div id="chartHours" class="ct-homepage"></div> -->
                                <div class="footer">
                                    <div class="chart-legend">
                                        <i class="fa fa-circle text-info"></i> Open
                                        <i class="fa fa-circle text-danger"></i> Click
                                        <i class="fa fa-circle text-warning"></i> Click Second Time
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated 3 minutes ago
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">实时监控-摄像头2</h4>
                                <p class="category">24 Hours performance</p>
                                <center>
                                    <img id="pic2" src="{% static '/img/wait.gif' %}">
                                    <img id="pic3" src="{% url 'video_feed2' %}">
                                </center>
                            </div>
                            <div class="content">
                                <!-- <div id="chartHours" class="ct-homepage"></div> -->
                                <div class="footer">
                                    <div class="chart-legend">
                                        <i class="fa fa-circle text-info"></i> Open
                                        <i class="fa fa-circle text-danger"></i> Click
                                        <i class="fa fa-circle text-warning"></i> Click Second Time
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-reload"></i> Updated 3 minutes ago
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">实时报表</h4>
                                <p class="category">Data Performance</p>
                                <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
                                <center>
                                <div id="bar" style="width: 800px;height:600px;"></div>
                                </center>
                            </div>
                            <div class="content">
                                <!-- <div id="chartPreferences" class="ct-homepage ct-perfect-fourth"></div> -->
                                <!-- 饼状图 -->

                                <div class="footer">
                                    <div class="chart-legend">
                                        <i class="fa fa-circle text-info"></i> Open
                                        <i class="fa fa-circle text-danger"></i> Bounce
                                        <i class="fa fa-circle text-warning"></i> Unsubscribe
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-timer"></i> Updated 5 seconds ago
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-md-6">
                        <div class="card ">
                            <div class="header">
                                <h4 class="title">2015 Sales</h4>
                                <p class="category">All products including Taxes</p>
                            </div>
                            <div class="content">
                                <div id="chartActivity" class="ct-homepage"></div>

                                <div class="footer">
                                    <div class="homepage-legend">
                                        <i class="fa fa-circle text-info"></i> Tesla Model S
                                        <i class="fa fa-circle text-warning"></i> BMW 5 Series
                                    </div>
                                    <hr>
                                    <div class="stats">
                                        <i class="ti-check"></i> Data information certified
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
</div>


</body>

    <!--   Core JS Files   -->
    <script src="{% static '/js/jquery-1.10.2.js' %}" type="text/javascript"></script>
	<script src="{% static '/js/bootstrap.min.js' %}" type="text/javascript"></script>
    <script src="{% static '/js/charts/echarts.min.js' %}"></script>
    <script src="{% static '/js/jquery.min.js' %}"></script>
    <script src="{% static '/js/jquery.timers-1.2.js' %}"></script>
	<!--  Checkbox, Radio & Switch Plugins -->
	<script src="{% static '/js/bootstrap-checkbox-radio.js' %}"></script>

    <!--  Notifications Plugin    -->
    <script src="{% static '/js/bootstrap-notify.js' %}"></script>

    <!--  Google Maps Plugin    -->
    <script type="text/javascript" src=""></script>

    <!-- Paper Dashboard Core javascript and methods for Demo purpose -->
	<script src="{% static '/js/paper-dashboard.js' %}"></script>

	<!-- Paper Dashboard DEMO methods, don't include it in your project! -->
	<script src="{% static '/js/demo.js' %}"></script>
<script src="{% static '/js/jquery.timers-1.2.js' %}"></script>
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('bar'));
        myChart.showLoading();
 setTimeout(function () {

    option = {
        legend: {},
        tooltip: {
            trigger: 'axis',
            showContent: false
        },
        dataset: {
            source: [['事件','情感检测','交互检测','陌生人检测','摔倒检测','禁止区域入侵检测'],],
        },
        xAxis: {type: 'category'},
        yAxis: {gridIndex: 0},
        grid: {top: '55%'},
        series: [
            {type: 'line', smooth: true, seriesLayoutBy: 'row'},
            {type: 'line', smooth: true, seriesLayoutBy: 'row'},
            {type: 'line', smooth: true, seriesLayoutBy: 'row'},
            {type: 'line', smooth: true, seriesLayoutBy: 'row'},
            {type: 'line', smooth: true, seriesLayoutBy: 'row'},
            {
                type: 'pie',
                id: 'pie',
                radius: '30%',
                center: ['50%', '25%'],
                label: {
                    formatter: '{b}: {@["情感检测"]} ({d}%)'
                },
                encode: {
                    itemName: "event",
                    value: "情感检测",
                    tooltip: "情感检测"
                }
            }
        ]
    };

    myChart.on('updateAxisPointer', function (event) {
        var xAxisInfo = event.axesInfo[0];

        if (xAxisInfo) {
            var dimension = xAxisInfo.value + 1;
            myChart.setOption({
                series: {
                    id: 'pie',
                    label: {
                        formatter: '{b}: {@[' + dimension + ']} ({d}%)'
                    },
                    encode: {
                        value: dimension,
                        tooltip: dimension
                    }
                }
            });
        }
    });

    myChart.setOption(option);

});;
    $('body').everyTime('2s','A',function(){
        $.ajax({
                url: "/getEvent",
                type: "POST",
                dataType:"json",
                success: function (data) {
                    myChart.setOption({
                        dataset: {source:data["events"]},
                    });
                    myChart.hideLoading();
                    document.getElementById("feeling").innerHTML = data["eventCounts"][0];
                    document.getElementById("communication").innerHTML = data["eventCounts"][1];
                    document.getElementById("stranger").innerHTML = data["eventCounts"][2];
                    document.getElementById("trip").innerHTML = data["eventCounts"][3];
                    document.getElementById("intrude").innerHTML = data["eventCounts"][4];


                    if (data["notifyList"]){
                        for(item in data["notifyList"]){
                            $.notify({
                                icon:"ti-info-alt",
                                url:"/eventRecord",
                                message: data["notifyList"][item]

                            },{
                                type: 'danger',
                                timer: 10000
                            });
                        }
                    }
                }
        });
    });


    </script>
	<script type="text/javascript">
	var isOK=false;
	var isSu=false;
    	$(document).ready(function(){

        	demo.initChartist();

        	$.notify({
            	icon: 'ti-gift',
            	message: "欢迎来到 <b>智慧养老系统</b> ！"

            },{
                type: 'success',
                timer: 4000
            });

    	});
    $('body').everyTime('2s','B',function(){
        $.ajax({
                url: '/update',
                type: "POST",
                success: function (data) {
                    data = JSON.parse(data);
                    debugger;
                    if (data["message"]['mes1']=="wait1") {
                        document.getElementById("pic").style.display="block";
                        document.getElementById("pic1").style.display="none";
                    }
                    else{
                        document.getElementById("pic").style.display="none";
                    }
                     if (data["message"]['mes2']=="wait2") {
                        document.getElementById("pic2").style.display="block";
                        document.getElementById("pic3").style.display="none";
                    }
                    else{
                        document.getElementById("pic2").style.display="none";
                    }


                }
            });
    });


	</script>
        <script type="text/javascript">
            //得到时间并写入div
            function getDate(){
                //获取当前时间
                var date = new Date();
                //格式化为本地时间格式
                var date1 = date.toLocaleString();
                //获取div
                var div1 = document.getElementById("times");
                //将时间写入div
                div1.innerHTML = date1;
            }
            //使用定时器每秒向div写入当前时间
            setInterval("getDate()",1000);
        </script>
</html>
